<!DOCTYPE html>
<html lang="en">
<head>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.jczs?client=ca-pub-8846557285079359"
     crossorigin="anonymous"></script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>JWT Decoder - Toolneat</title>
  <meta name="description" content="Decode and analyze JWT (JSON Web Tokens) online for free. View Header, Payload, and Signature components separately with human-readable claim information including expiration, issued time, and permissions. Verify signature validity with your secret key.">

  <!-- Canonical & hreflang -->
  <link rel="canonical" href="https://toolneat.com/en/tools/dev/jwt-decoder">
  <link rel="alternate" hreflang="en" href="https://toolneat.com/en/tools/dev/jwt-decoder">
  <link rel="alternate" hreflang="ko" href="https://toolneat.com/tools/dev/jwt-decoder">
  <link rel="alternate" hreflang="x-default" href="https://toolneat.com/tools/dev/jwt-decoder">

  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="Toolneat">
  <meta property="og:title" content="JWT Decoder - Toolneat">
  <meta property="og:description" content="Decode JSON Web Tokens (JWT) to view Header, Payload, and Signature. Verify token expiration and claims.">
  <meta property="og:url" content="https://toolneat.com/en/tools/dev/jwt-decoder">
  <meta property="og:image" content="https://toolneat.com/assets/images/og-image.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="theme-color" content="#2563eb">

  <!-- Favicon -->
  <!-- CSS -->
    <link rel="icon" href="/favicon.ico" sizes="any">
  <link rel="icon" type="image/svg+xml" href="/assets/icons/favicon.svg">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/icons/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/apple-touch-icon.png">
  <link rel="manifest" href="/manifest.json">
  <link rel="stylesheet" href="../../../../assets/css/output.css">

  <!-- JS -->
  <script src="https://cdn.jsdelivr.net/npm/fuse.js@7.0.0"></script>
  <script src="../../../../assets/js/common.js"></script>
  <script>
    // Force English language
    localStorage.setItem('toolneat-lang', 'en');
  </script>
  <script src="../../../../assets/js/i18n.js"></script>
  <script src="../../../../assets/js/components.js"></script>

  <style>
    .jwt-part {
      padding: 1rem;
      border-radius: 0.75rem;
      margin-bottom: 1rem;
    }
    .jwt-header {
      background-color: #fef3c7;
      border: 1px solid #fcd34d;
    }
    .dark .jwt-header {
      background-color: #78350f;
      border-color: #92400e;
    }
    .jwt-payload {
      background-color: #dbeafe;
      border: 1px solid #93c5fd;
    }
    .dark .jwt-payload {
      background-color: #1e3a8a;
      border-color: #1d4ed8;
    }
    .jwt-signature {
      background-color: #fce7f3;
      border: 1px solid #f9a8d4;
    }
    .dark .jwt-signature {
      background-color: #831843;
      border-color: #9d174d;
    }
    .claim-row {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      padding: 0.5rem 0;
      border-bottom: 1px solid #e5e7eb;
    }
    .dark .claim-row {
      border-bottom-color: #374151;
    }
    .claim-row:last-child {
      border-bottom: none;
    }
    .claim-key {
      font-family: ui-monospace, monospace;
      font-weight: 600;
      color: #1f2937;
      min-width: 80px;
    }
    .dark .claim-key {
      color: #f3f4f6;
    }
    .claim-value {
      font-family: ui-monospace, monospace;
      color: #4b5563;
      word-break: break-all;
      text-align: right;
      flex: 1;
      margin-left: 1rem;
    }
    .dark .claim-value {
      color: #d1d5db;
    }
    .status-valid {
      color: #059669;
    }
    .status-expired {
      color: #dc2626;
    }
    .status-not-yet {
      color: #d97706;
    }
    .token-preview {
      font-family: ui-monospace, monospace;
      font-size: 0.75rem;
      word-break: break-all;
      line-height: 1.5;
    }
    .token-header { color: #d97706; }
    .token-payload { color: #2563eb; }
    .token-signature { color: #db2777; }
    .dark .token-header { color: #fbbf24; }
    .dark .token-payload { color: #60a5fa; }
    .dark .token-signature { color: #f472b6; }
  </style>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebApplication",
  "name": "JWT Decoder",
  "description": "Decode and analyze JWT (JSON Web Tokens) online for free. View Header, Payload, and Signature components separately with human-readable claim information including expiration, issued time, and permissions. Verify signature validity with your secret key.",
  "url": "https://toolneat.com/en/tools/dev/jwt-decoder",
  "applicationCategory": "DeveloperApplication",
  "operatingSystem": "Any",
  "browserRequirements": "Requires JavaScript",
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "USD"
  },
  "author": {
    "@type": "Organization",
    "name": "Toolneat",
    "url": "https://toolneat.com"
  }
}
</script>  <script src="../../../../assets/js/tools-data.js"></script>
  <script src="../../../../assets/js/search.js" defer></script>
</head>
<body class="min-h-screen flex flex-col">
  <!-- Header -->
  <div id="header">
<header class="fixed top-0 left-0 right-0 z-50 bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700">
  <div class="container-main">
    <div class="flex items-center justify-between h-16">
      <!-- Logo -->
      <a href="/en" class="nav-link text-xl font-bold text-gray-900 dark:text-white hover:text-blue-600 dark:hover:text-blue-400 transition-colors">
        Toolneat
      </a>

      <!-- Desktop Nav - 오버레이 트리거 버튼들 -->
      <nav class="hidden md:flex items-center gap-2">
        <button class="tools-overlay-trigger nav-dropdown-btn" data-category="dev">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"/>
          </svg>
          <span data-i18n="nav.dev">Dev Tools</span>
        </button>

        <button class="tools-overlay-trigger nav-dropdown-btn" data-category="pdf">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"/>
          </svg>
          <span data-i18n="nav.pdf">PDF Tools</span>
        </button>

        <button class="tools-overlay-trigger nav-dropdown-btn" data-category="life">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"/>
          </svg>
          <span data-i18n="nav.life">Life Tools</span>
        </button>

        <button class="tools-overlay-trigger nav-dropdown-btn" data-category="game">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"/>
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
          </svg>
          <span data-i18n="nav.game">Games</span>
        </button>

        <a href="/blog" class="nav-link nav-dropdown-btn">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"/>
          </svg>
          <span data-i18n="nav.blog">Blog</span>
        </a>
      </nav>

      <!-- Actions -->
      <div class="flex items-center gap-2">
        <!-- Search Button -->
        <button id="header-search-btn" class="hidden sm:flex items-center gap-2 px-3 py-1.5 text-sm text-gray-500 dark:text-gray-400 bg-gray-100 dark:bg-gray-800 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
          </svg>
          <span class="hidden lg:inline" data-i18n="nav.search">Search</span>
          <kbd class="hidden lg:inline-flex items-center gap-0.5 px-1.5 py-0.5 text-[10px] font-medium bg-gray-200 dark:bg-gray-700 rounded">
            <span class="text-[9px]">Ctrl</span>K
          </kbd>
        </button>

        <!-- Language Toggle -->
        <div class="hidden sm:flex items-center gap-1 text-sm">
          <button data-lang="ko" class="px-2 py-1 rounded text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 transition-all">KO</button>
          <span class="text-gray-300 dark:text-gray-600">|</span>
          <button data-lang="en" class="px-2 py-1 rounded text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 transition-all">EN</button>
        </div>

        <!-- Theme Toggle -->
        <button id="theme-toggle" class="icon-btn" aria-label="Toggle theme">
          <svg id="sun-icon" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/>
          </svg>
          <svg id="moon-icon" class="w-5 h-5 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"/>
          </svg>
        </button>

        <!-- Mobile Menu Button -->
        <button id="menu-toggle" class="icon-btn md:hidden" aria-label="Menu">
          <svg id="menu-icon" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
          </svg>
          <svg id="close-icon" class="w-5 h-5 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
          </svg>
        </button>
      </div>
    </div>

    <!-- Mobile Menu (2-level accordion) -->
    <nav id="mobile-menu" class="hidden md:hidden pb-4 max-h-[calc(100vh-4rem)] overflow-y-auto">
      <!-- Mobile Search Button -->
      <button id="mobile-search-btn" class="w-full flex items-center gap-3 py-3 px-3 mb-2 bg-gray-100 dark:bg-gray-800 rounded-xl text-gray-500 dark:text-gray-400">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
        </svg>
        <span data-i18n="nav.search">Search</span>
      </button>

      <!-- Language (Mobile) -->
      <div class="flex items-center gap-2 py-3 border-b border-gray-100 dark:border-gray-800 mb-2">
        <span class="text-sm text-gray-500">Language:</span>
        <button data-lang="ko" class="px-3 py-1 rounded text-sm text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800">KO</button>
        <button data-lang="en" class="px-3 py-1 rounded text-sm text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800">EN</button>
      </div>

      <!-- Dev Tools (Mobile - 2-level) -->
      <div class="mobile-accordion">
        <button class="mobile-accordion-btn w-full flex items-center justify-between py-3 text-gray-900 dark:text-white font-medium">
          <span class="flex items-center gap-2">
            <svg class="w-5 h-5 text-blue-600 dark:text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"/>
            </svg>
            <span data-i18n="nav.dev">Dev Tools</span>
          </span>
          <svg class="w-4 h-4 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
          </svg>
        </button>
        <div class="mobile-accordion-content hidden pl-4">
          <!-- Encoding/Decoding -->
          <div class="mobile-sub-accordion">
            <button class="mobile-sub-accordion-btn w-full flex items-center justify-between py-2 text-gray-700 dark:text-gray-300 text-sm font-medium">
              <span data-i18n="nav.encoding">Encoding</span>
              <svg class="w-3 h-3 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
              </svg>
            </button>
            <div class="mobile-sub-content hidden pl-4 space-y-1">
              <a href="/en/tools/dev/base64" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.base64.title">Base64 Encode/Decode</a>
              <a href="/en/tools/dev/url-encoder" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.urlEncoder.title">URL Encode/Decode</a>
              <a href="/en/tools/dev/html-entity" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.htmlEntity.title">HTML Entity Encoder</a>
              <a href="/en/tools/dev/text-escape" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400">텍스트 이스케이프</a>
            </div>
          </div>
          <!-- Generators -->
          <div class="mobile-sub-accordion">
            <button class="mobile-sub-accordion-btn w-full flex items-center justify-between py-2 text-gray-700 dark:text-gray-300 text-sm font-medium">
              <span data-i18n="nav.generators">Generators</span>
              <svg class="w-3 h-3 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
              </svg>
            </button>
            <div class="mobile-sub-content hidden pl-4 space-y-1">
              <a href="/en/tools/dev/uuid-generator" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.uuidGenerator.title">UUID Generator</a>
              <a href="/en/tools/dev/hash-generator" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.hashGenerator.title">Hash Generator</a>
              <a href="/en/tools/dev/lorem-ipsum" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.loremIpsum.title">Lorem Ipsum Generator</a>
              <a href="/en/tools/dev/jwt-generator" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.jwtGenerator.title">JWT Generator</a>
              <a href="/en/tools/dev/password-generator" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.passwordGenerator.title">Password Generator</a>
              <a href="/en/tools/dev/cron-generator" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.cronGenerator.title">Cron Expression Generator</a>
              <a href="/en/tools/dev/gradient-generator" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.gradientGenerator.title">Gradient Generator</a>
              <a href="/en/tools/dev/meta-tag-generator" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.metaTagGenerator.title">Meta Tag Generator</a>
              <a href="/en/tools/dev/utm-generator" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.utmGenerator.title">UTM Builder</a>
              <a href="/en/tools/dev/robots-txt" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.robotsTxt.title">Robots.txt Generator</a>
              <a href="/en/tools/dev/box-shadow" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.boxShadow.title">Box Shadow Generator</a>
            </div>
          </div>
          <!-- Converters -->
          <div class="mobile-sub-accordion">
            <button class="mobile-sub-accordion-btn w-full flex items-center justify-between py-2 text-gray-700 dark:text-gray-300 text-sm font-medium">
              <span data-i18n="nav.converters">Converters</span>
              <svg class="w-3 h-3 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
              </svg>
            </button>
            <div class="mobile-sub-content hidden pl-4 space-y-1">
              <a href="/en/tools/dev/json-formatter" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.jsonFormatter.title">JSON Formatter</a>
              <a href="/en/tools/dev/color-converter" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.colorConverter.title">Color Converter</a>
              <a href="/en/tools/dev/color-palette" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.colorPalette.title">Color Palette Extractor</a>
              <a href="/en/tools/dev/timestamp-converter" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.timestampConverter.title">Unix Timestamp Converter</a>
              <a href="/en/tools/dev/yaml-json" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.yamlJson.title">YAML ↔ JSON Converter</a>
              <a href="/en/tools/dev/xml-json" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.xmlJson.title">XML ↔ JSON Converter</a>
              <a href="/en/tools/dev/markdown-preview" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.markdownPreview.title">Markdown Preview</a>
              <a href="/en/tools/dev/case-converter" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.caseConverter.title">Case Converter</a>
              <a href="/en/tools/dev/sql-formatter" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.sqlFormatter.title">SQL Formatter</a>
              <a href="/en/tools/dev/css-minifier" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.cssMinifier.title">CSS Minifier/Beautifier</a>
              <a href="/en/tools/dev/line-ending" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.lineEnding.title">Line Ending Converter</a>
              <a href="/en/tools/dev/json-csv" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.jsonCsv.title">JSON CSV Converter</a>
              <a href="/en/tools/dev/js-minifier" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.jsMinifier.title">JavaScript Minifier</a>
              <a href="/en/tools/dev/html-minifier" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.htmlMinifier.title">HTML Minifier</a>
            </div>
          </div>
          <!-- Testers -->
          <div class="mobile-sub-accordion">
            <button class="mobile-sub-accordion-btn w-full flex items-center justify-between py-2 text-gray-700 dark:text-gray-300 text-sm font-medium">
              <span data-i18n="nav.testers">Testers</span>
              <svg class="w-3 h-3 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
              </svg>
            </button>
            <div class="mobile-sub-content hidden pl-4 space-y-1">
              <a href="/en/tools/dev/regex-tester" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.regexTester.title">Regex Tester</a>
              <a href="/en/tools/dev/jwt-decoder" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.jwtDecoder.title">JWT Decoder</a>
              <a href="/en/tools/dev/diff-checker" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.diffChecker.title">Text Diff Checker</a>
              <a href="/en/tools/dev/color-contrast" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.colorContrast.title">Color Contrast Checker</a>
              <a href="/en/tools/dev/og-preview" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.ogPreview.title">Open Graph Preview</a>
              <a href="/en/tools/dev/json-validator" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.jsonValidator.title">JSON Validator</a>
            </div>
          </div>
        </div>
      </div>

      <!-- PDF Tools (Mobile - 2-level) -->
      <div class="mobile-accordion">
        <button class="mobile-accordion-btn w-full flex items-center justify-between py-3 text-gray-900 dark:text-white font-medium">
          <span class="flex items-center gap-2">
            <svg class="w-5 h-5 text-red-600 dark:text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"/>
            </svg>
            <span data-i18n="nav.pdf">PDF Tools</span>
          </span>
          <svg class="w-4 h-4 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
          </svg>
        </button>
        <div class="mobile-accordion-content hidden pl-4">
          <!-- PDF Edit -->
          <div class="mobile-sub-accordion">
            <button class="mobile-sub-accordion-btn w-full flex items-center justify-between py-2 text-gray-700 dark:text-gray-300 text-sm font-medium">
              <span data-i18n="nav.pdfEdit">PDF Edit</span>
              <svg class="w-3 h-3 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
              </svg>
            </button>
            <div class="mobile-sub-content hidden pl-4 space-y-1">
              <a href="/en/tools/pdf/merge-pdf" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.mergePdf.title">Merge PDF</a>
              <a href="/en/tools/pdf/split-pdf" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.splitPdf.title">Split PDF</a>
              <a href="/en/tools/pdf/compress-pdf" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.compressPdf.title">Compress PDF</a>
              <a href="/en/tools/pdf/rotate-pdf" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.rotatePdf.title">Rotate PDF</a>
              <a href="/en/tools/pdf/watermark-pdf" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.watermarkPdf.title">PDF Watermark</a>
              <a href="/en/tools/pdf/delete-pdf" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.deletePdf.title">Delete PDF Pages</a>
              <a href="/en/tools/pdf/reorder-pdf" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.reorderPdf.title">Reorder PDF Pages</a>
            </div>
          </div>
          <!-- PDF Convert -->
          <div class="mobile-sub-accordion">
            <button class="mobile-sub-accordion-btn w-full flex items-center justify-between py-2 text-gray-700 dark:text-gray-300 text-sm font-medium">
              <span data-i18n="nav.pdfConvert">PDF Convert</span>
              <svg class="w-3 h-3 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
              </svg>
            </button>
            <div class="mobile-sub-content hidden pl-4 space-y-1">
              <a href="/en/tools/pdf/pdf-to-image" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.pdfToImage.title">PDF to Image</a>
              <a href="/en/tools/pdf/image-to-pdf" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.imageToPdf.title">Image to PDF</a>
            </div>
          </div>
        </div>
      </div>

      <!-- Life Tools (Mobile - 2-level) -->
      <div class="mobile-accordion">
        <button class="mobile-accordion-btn w-full flex items-center justify-between py-3 text-gray-900 dark:text-white font-medium">
          <span class="flex items-center gap-2">
            <svg class="w-5 h-5 text-green-600 dark:text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"/>
            </svg>
            <span data-i18n="nav.life">Life Tools</span>
          </span>
          <svg class="w-4 h-4 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
          </svg>
        </button>
        <div class="mobile-accordion-content hidden pl-4">
          <!-- Calculators -->
          <div class="mobile-sub-accordion">
            <button class="mobile-sub-accordion-btn w-full flex items-center justify-between py-2 text-gray-700 dark:text-gray-300 text-sm font-medium">
              <span data-i18n="nav.calculators">Calculators</span>
              <svg class="w-3 h-3 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
              </svg>
            </button>
            <div class="mobile-sub-content hidden pl-4 space-y-1">
              <a href="/en/tools/life/salary-calculator" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.salaryCalculator.title">Salary Calculator (Korea)</a>
              <a href="/en/tools/life/dday-calculator" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.ddayCalculator.title">D-day Calculator</a>
              <a href="/en/tools/life/bmi-calculator" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.bmiCalculator.title">BMI Calculator</a>
              <a href="/en/tools/life/loan-calculator" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.loanCalculator.title">Loan Calculator</a>
              <a href="/en/tools/life/age-calculator" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.ageCalculator.title">Age Calculator</a>
              <a href="/en/tools/life/percent-calculator" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.percentCalculator.title">Percentage Calculator</a>
              <a href="/en/tools/life/compound-calculator" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.compoundCalculator.title">Compound Interest Calculator</a>
              <a href="/en/tools/life/tip-calculator" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.tipCalculator.title">Tip Calculator</a>
              <a href="/en/tools/life/sleep-calculator" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.sleepCalculator.title">Sleep Calculator</a>
            </div>
          </div>
          <!-- Media & AI -->
          <div class="mobile-sub-accordion">
            <button class="mobile-sub-accordion-btn w-full flex items-center justify-between py-2 text-gray-700 dark:text-gray-300 text-sm font-medium">
              <span data-i18n="nav.mediaAi">Media & AI</span>
              <svg class="w-3 h-3 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
              </svg>
            </button>
            <div class="mobile-sub-content hidden pl-4 space-y-1">
              <a href="/en/tools/life/background-remover" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.backgroundRemover.title">Background Remover AI</a>
              <a href="/en/tools/life/video-to-gif" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.videoToGif.title">Video to GIF</a>
              <a href="/en/tools/life/screen-recorder" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.screenRecorder.title">Screen Recorder</a>
              <a href="/en/tools/life/ocr" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.ocr.title">OCR Text Extractor</a>
              <a href="/en/tools/life/meme-generator" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.memeGenerator.title">Meme Generator</a>
              <a href="/en/tools/life/speech-to-text" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.speechToText.title">Speech to Text</a>
              <a href="/en/tools/life/text-to-speech" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.textToSpeech.title">Text to Speech</a>
            </div>
          </div>
          <!-- Utilities -->
          <div class="mobile-sub-accordion">
            <button class="mobile-sub-accordion-btn w-full flex items-center justify-between py-2 text-gray-700 dark:text-gray-300 text-sm font-medium">
              <span data-i18n="nav.utilities">Utilities</span>
              <svg class="w-3 h-3 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
              </svg>
            </button>
            <div class="mobile-sub-content hidden pl-4 space-y-1">
              <a href="/en/tools/life/character-counter" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.characterCounter.title">Character Counter</a>
              <a href="/en/tools/life/unit-converter" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.unitConverter.title">Unit Converter</a>
              <a href="/en/tools/life/qr-generator" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.qrGenerator.title">QR Code Generator</a>
              <a href="/en/tools/life/qr-scanner" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.qrScanner.title">QR Code Scanner</a>
              <a href="/en/tools/life/barcode-generator" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.barcodeGenerator.title">Barcode Generator</a>
              <a href="/en/tools/life/favicon-generator" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.faviconGenerator.title">Favicon Generator</a>
              <a href="/en/tools/life/image-compressor" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.imageCompressor.title">Image Compressor</a>
              <a href="/en/tools/life/image-resizer" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.imageResizer.title">Image Resizer</a>
              <a href="/en/tools/life/image-converter" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.imageConverter.title">Image Format Converter</a>
              <a href="/en/tools/life/image-watermark" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.imageWatermark.title">Image Watermark</a>
              <a href="/en/tools/life/image-crop" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.imageCrop.title">Image Crop</a>
              <a href="/en/tools/life/image-rotate" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.imageRotate.title">Image Rotate</a>
              <a href="/en/tools/life/exif-remover" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.exifRemover.title">EXIF Remover</a>
              <a href="/en/tools/life/color-picker" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.colorPicker.title">Color Picker (EyeDropper)</a>
              <a href="/en/tools/life/pomodoro-timer" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.pomodoroTimer.title">Pomodoro Timer</a>
              <a href="/en/tools/life/base-converter" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.baseConverter.title">Number Base Converter</a>
              <a href="/en/tools/life/ascii-unicode" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.asciiUnicode.title">ASCII/Unicode Converter</a>
              <a href="/en/tools/life/emoji-picker" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.emojiPicker.title">Emoji Picker</a>
              <a href="/en/tools/life/countdown-timer" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.countdownTimer.title">Countdown Timer</a>
              <a href="/en/tools/life/aspect-ratio" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.aspectRatio.title">Aspect Ratio Calculator</a>
              <a href="/en/tools/life/ip-lookup" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.ipLookup.title">IP Address Lookup</a>
              <a href="/en/tools/life/ai-detector" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.aiDetector.title">AI Text Detector</a>
              <a href="/en/tools/life/youtube-thumbnail" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.youtubeThumbnail.title">YouTube Thumbnail Downloader</a>
              <a href="/en/tools/life/morse-code" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.morseCode.title">Morse Code Converter</a>
              <a href="/en/tools/life/noise-generator" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.noiseGenerator.title">Noise Generator</a>
              <a href="/en/tools/life/fake-chat" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.fakeChat.title">Fake Chat Generator</a>
              <a href="/en/tools/life/fancy-text" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.fancyText.title">Fancy Text Generator</a>
              <a href="/en/tools/life/webcam-test" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.webcamTest.title">Webcam Test</a>
              <a href="/en/tools/life/mic-test" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.micTest.title">Microphone Test</a>
              <a href="/en/tools/life/image-blur" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.imageBlur.title">Image Blur/Mosaic</a>
              <a href="/en/tools/life/korean-name-generator" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.koreanNameGenerator.title">Korean Name Generator</a>
            </div>
          </div>
          <!-- Monitor Test -->
          <div class="mobile-sub-accordion">
            <button class="mobile-sub-accordion-btn w-full flex items-center justify-between py-2 text-gray-700 dark:text-gray-300 text-sm font-medium">
              <span data-i18n="nav.monitorTest">Monitor Test</span>
              <svg class="w-3 h-3 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
              </svg>
            </button>
            <div class="mobile-sub-content hidden pl-4 space-y-1">
              <a href="/en/tools/life/dead-pixel-test" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.deadPixelTest.title">Dead Pixel Test</a>
              <a href="/en/tools/life/pixel-fixer" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.pixelFixer.title">Pixel Fixer</a>
              <a href="/en/tools/life/screen-burn-test" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.screenBurnTest.title">Screen Burn-In Test</a>
              <a href="/en/tools/life/screen-color-test" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.screenColorTest.title">Screen Color Test</a>
            </div>
          </div>
          <!-- Fun & Games -->
          <div class="mobile-sub-accordion">
            <button class="mobile-sub-accordion-btn w-full flex items-center justify-between py-2 text-gray-700 dark:text-gray-300 text-sm font-medium">
              <span data-i18n="nav.funGames">Fun & Games</span>
              <svg class="w-3 h-3 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
              </svg>
            </button>
            <div class="mobile-sub-content hidden pl-4 space-y-1">
              <a href="/en/tools/life/lottery-generator" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.lotteryGenerator.title">Lottery Number Generator</a>
              <a href="/en/tools/life/roulette" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.roulette.title">Roulette Wheel</a>
              <a href="/en/tools/life/dice-roller" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.diceRoller.title">Dice Roller</a>
              <a href="/en/tools/life/coin-flip" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.coinFlip.title">Coin Flip</a>
              <a href="/en/tools/life/typing-test" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.typingTest.title">Typing Test</a>
              <a href="/en/tools/life/reaction-test" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.reactionTest.title">Reaction Time Test</a>
              <a href="/en/tools/life/stopwatch" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.stopwatch.title">Stopwatch</a>
            </div>
          </div>
        </div>
      </div>

      <!-- Game (Mobile) -->
      <div class="mobile-accordion">
        <button class="mobile-accordion-btn w-full flex items-center justify-between py-3 text-gray-900 dark:text-white font-medium">
          <span class="flex items-center gap-2">
            <svg class="w-5 h-5 text-purple-600 dark:text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"/>
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            <span data-i18n="nav.game">Games</span>
          </span>
          <svg class="w-4 h-4 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
          </svg>
        </button>
        <div class="mobile-accordion-content hidden pl-4 space-y-1">
          <a href="/en/tools/game/2048" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.2048.title">2048</a>
          <a href="/en/tools/game/minesweeper" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.minesweeper.title">Minesweeper</a>
          <a href="/en/tools/game/snake" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.snake.title">Snake</a>
          <a href="/en/tools/game/memory-game" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.memoryGame.title">Memory Game</a>
          <a href="/en/tools/game/tetris" class="nav-link block py-1.5 text-sm text-gray-600 dark:text-gray-400" data-i18n="tools.tetris.title">Tetris</a>
        </div>
      </div>

      <!-- Blog (Mobile) -->
      <a href="/blog" class="nav-link flex items-center gap-2 py-3 text-gray-900 dark:text-white font-medium">
        <svg class="w-5 h-5 text-gray-600 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"/>
        </svg>
        <span data-i18n="nav.blog">Blog</span>
      </a>
    </nav>
  </div>
</header>

<!-- Tools Dropdown (PC Only - 헤더 바로 아래 붙는 방식) -->
<div id="tools-dropdown" class="hidden fixed left-0 right-0 top-16 z-[60] bg-white dark:bg-gray-900 shadow-2xl border-b border-gray-200 dark:border-gray-700">
  <div class="container-main py-4">
    <!-- Header: Tabs + Search + Close -->
    <div class="flex items-center justify-between gap-4 mb-4">
      <!-- Category Tabs -->
      <div class="flex items-center gap-1">
        <button class="tools-tab px-3 py-1.5 rounded-lg text-sm font-medium transition-colors bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700" data-tab="all">
          <span data-i18n="nav.all">All</span>
        </button>
        <button class="tools-tab px-3 py-1.5 rounded-lg text-sm font-medium transition-colors bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700" data-tab="dev">
          <span data-i18n="nav.dev">Dev Tools</span>
        </button>
        <button class="tools-tab px-3 py-1.5 rounded-lg text-sm font-medium transition-colors bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700" data-tab="pdf">
          <span data-i18n="nav.pdf">PDF Tools</span>
        </button>
        <button class="tools-tab px-3 py-1.5 rounded-lg text-sm font-medium transition-colors bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700" data-tab="life">
          <span data-i18n="nav.life">Life Tools</span>
        </button>
        <button class="tools-tab px-3 py-1.5 rounded-lg text-sm font-medium transition-colors bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700" data-tab="game">
          <span data-i18n="nav.game">Games</span>
        </button>
      </div>

      <!-- Search + Close -->
      <div class="flex items-center gap-2">
        <div class="relative">
          <svg class="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
          </svg>
          <input type="text" id="tools-dropdown-search" class="w-64 pl-9 pr-4 py-1.5 bg-gray-100 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg text-sm text-gray-900 dark:text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="도구 검색..." data-i18n-placeholder="nav.searchPlaceholder">
        </div>
        <button id="tools-dropdown-close" class="p-1.5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
          </svg>
        </button>
      </div>
    </div>

    <!-- Tools Grid (고정 높이 + 스크롤) -->
    <div class="max-h-[420px] overflow-y-auto">
      <div id="tools-grid" class="grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 xl:grid-cols-7 gap-2">
        <!-- Tools will be populated by JS -->
      </div>
    </div>
  </div>
</div>

<!-- Dropdown Backdrop (헤더 아래부터 시작) -->
<div id="tools-dropdown-backdrop" class="hidden fixed inset-0 top-16 z-[55] bg-black/60"></div>

</div><main class="flex-1 mt-16 py-8 md:py-12">
    <div class="container-main">
      <!-- Page Title -->
      <div class="mb-6">
        <h1 class="text-2xl md:text-3xl font-bold text-gray-900 dark:text-white mb-2">
          JWT Decoder
        </h1>
        <p class="text-gray-600 dark:text-gray-400">
          Decode JSON Web Tokens (JWT) to view the Header, Payload, and Signature. Easily check token expiration and claim information.
        </p>
      </div>

      <!-- Ad Container (Top) -->
      <div class="ad-container mb-6">

      </div>

      <!-- Tool Card -->
      <div class="card">
        <!-- Input -->
        <div class="mb-6">
          <div class="flex items-center justify-between mb-2">
            <label class="text-sm font-medium text-gray-700 dark:text-gray-300">JWT Token</label>
            <button id="paste-btn" class="text-sm text-blue-600 dark:text-blue-400 hover:underline">Paste</button>
          </div>
          <textarea id="jwt-input" class="textarea h-32 font-mono text-sm" placeholder="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c"></textarea>
        </div>

        <!-- Decode Button -->
        <button id="decode-btn" class="btn btn-primary w-full mb-6">Decode</button>

        <!-- Error Message -->
        <div id="error-message" class="hidden mb-6 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl text-red-600 dark:text-red-400"></div>

        <!-- Results -->
        <div id="results" class="hidden">
          <!-- Token Status -->
          <div id="token-status" class="mb-6 p-4 rounded-xl"></div>

          <!-- Token Preview -->
          <div class="mb-6">
            <h3 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Token Structure</h3>
            <div class="p-4 bg-gray-50 dark:bg-gray-900 rounded-xl">
              <div id="token-preview" class="token-preview"></div>
            </div>
          </div>

          <!-- Header -->
          <div class="jwt-part jwt-header">
            <div class="flex items-center justify-between mb-3">
              <h3 class="font-medium text-amber-800 dark:text-amber-200">Header</h3>
              <button class="copy-part-btn text-amber-600 dark:text-amber-400 text-sm hover:underline" data-part="header">Copy</button>
            </div>
            <pre id="header-json" class="text-sm font-mono text-amber-900 dark:text-amber-100 whitespace-pre-wrap"></pre>
          </div>

          <!-- Payload -->
          <div class="jwt-part jwt-payload">
            <div class="flex items-center justify-between mb-3">
              <h3 class="font-medium text-blue-800 dark:text-blue-200">Payload</h3>
              <button class="copy-part-btn text-blue-600 dark:text-blue-400 text-sm hover:underline" data-part="payload">Copy</button>
            </div>
            <pre id="payload-json" class="text-sm font-mono text-blue-900 dark:text-blue-100 whitespace-pre-wrap"></pre>
          </div>

          <!-- Signature -->
          <div class="jwt-part jwt-signature">
            <div class="flex items-center justify-between mb-3">
              <h3 class="font-medium text-pink-800 dark:text-pink-200">Signature</h3>
              <button class="copy-part-btn text-pink-600 dark:text-pink-400 text-sm hover:underline" data-part="signature">Copy</button>
            </div>
            <code id="signature-value" class="text-sm font-mono text-pink-900 dark:text-pink-100 break-all"></code>

            <!-- Signature Verification -->
            <div class="mt-4 pt-4 border-t border-pink-200 dark:border-pink-700">
              <label class="block text-sm font-medium text-pink-800 dark:text-pink-200 mb-2">Secret Key</label>
              <div class="flex gap-2">
                <input type="text" id="secret-key" class="input flex-1 font-mono text-sm bg-white dark:bg-gray-800" placeholder="your-256-bit-secret">
                <button id="verify-btn" class="btn btn-secondary shrink-0">Verify</button>
              </div>
              <div id="verify-result" class="mt-2 hidden"></div>
              <p class="mt-2 text-xs text-pink-700 dark:text-pink-300">Only HMAC algorithms (HS256, HS384, HS512) are supported.</p>
            </div>
          </div>

          <!-- Claims Detail -->
          <div id="claims-section" class="mt-6">
            <h3 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-3">Claims Details</h3>
            <div id="claims-list" class="bg-gray-50 dark:bg-gray-900 rounded-xl p-4"></div>
          </div>
        </div>
      </div>

      <!-- Standard Claims Card -->
      <div class="card mt-6">
        <h3 class="font-medium text-gray-900 dark:text-white mb-4">Standard Claims (Registered Claims)</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
          <div>
            <code class="text-blue-600 dark:text-blue-400">iss</code>
            <span class="text-gray-600 dark:text-gray-400"> - </span>
            <span class="text-gray-700 dark:text-gray-300">Issuer</span>
          </div>
          <div>
            <code class="text-blue-600 dark:text-blue-400">sub</code>
            <span class="text-gray-600 dark:text-gray-400"> - </span>
            <span class="text-gray-700 dark:text-gray-300">Subject</span>
          </div>
          <div>
            <code class="text-blue-600 dark:text-blue-400">aud</code>
            <span class="text-gray-600 dark:text-gray-400"> - </span>
            <span class="text-gray-700 dark:text-gray-300">Audience</span>
          </div>
          <div>
            <code class="text-blue-600 dark:text-blue-400">exp</code>
            <span class="text-gray-600 dark:text-gray-400"> - </span>
            <span class="text-gray-700 dark:text-gray-300">Expiration Time</span>
          </div>
          <div>
            <code class="text-blue-600 dark:text-blue-400">nbf</code>
            <span class="text-gray-600 dark:text-gray-400"> - </span>
            <span class="text-gray-700 dark:text-gray-300">Not Before</span>
          </div>
          <div>
            <code class="text-blue-600 dark:text-blue-400">iat</code>
            <span class="text-gray-600 dark:text-gray-400"> - </span>
            <span class="text-gray-700 dark:text-gray-300">Issued At</span>
          </div>
          <div>
            <code class="text-blue-600 dark:text-blue-400">jti</code>
            <span class="text-gray-600 dark:text-gray-400"> - </span>
            <span class="text-gray-700 dark:text-gray-300">JWT ID</span>
          </div>
        </div>
      </div>

      <!-- Ad Container (Bottom) -->
      <div class="ad-container mt-8">

      </div>

      <!-- Description Section -->
      <section class="mt-10 bg-white dark:bg-gray-800 rounded-xl p-5 shadow border border-gray-200 dark:border-gray-600">
        <h2 class="text-xl font-bold text-gray-900 dark:text-white mb-4">JWT Decoder Guide</h2>
        <div class="prose prose-gray dark:prose-invert max-w-none text-sm">

          <h3 class="text-lg font-bold mt-8 mb-2">About a JWT (JSON Web Token)</h3>
          <p>JWT is an open standard (RFC 7519) for securely transmitting JSON-formatted data between parties. It is widely used for authentication, authorization, and information exchange in web applications. A JWT consists of three parts separated by dots: Header (algorithm info), Payload (actual data/claims), and Signature (integrity check). The server verifies the signature with a secret key to confirm the token has not been tampered with.</p>

          <h3 class="text-lg font-bold mt-8 mb-2">User Guide</h3>
          <ol class="list-decimal pl-5 space-y-1.5">
            <li>Paste your JWT token string into the input field. It will auto-decode when pasted from the clipboard.</li>
            <li>Click the "Decode" button to see the Header, Payload, and Signature displayed as formatted JSON.</li>
            <li>Check the token status indicator to see whether the token is currently valid or expired.</li>
            <li>Review the claims detail section for each claim's key, value, and meaning.</li>
            <li>To verify the signature, enter the secret key and click the "Verify" button.</li>
          </ol>

          <h3 class="text-lg font-bold mt-8 mb-2">Core Features</h3>
          <ul class="list-disc pl-5 space-y-1.5">
            <li>Splits JWT tokens into Header, Payload, and Signature with formatted JSON display</li>
            <li>Automatically detects token status: valid, expired, or not yet valid</li>
            <li>Shows remaining validity time or how long ago the token expired</li>
            <li>Explains registered claims (sub, iss, aud, exp, iat, nbf, jti) with descriptions</li>
            <li>Verifies HMAC-based signatures (HS256, HS384, HS512)</li>
            <li>Auto-decodes on paste for a fast workflow</li>
          </ul>

          <h3 class="text-lg font-bold mt-8 mb-2">When This Comes in Handy</h3>
          <ul class="list-disc pl-5 space-y-1.5">
            <li>Quickly inspecting the payload of an authentication token during API development</li>
            <li>Debugging token expiration times or checking validity periods</li>
            <li>Analyzing the claim structure of JWTs received from third-party services</li>
            <li>Examining access tokens issued during OAuth 2.0 flows</li>
            <li>Verifying the signing algorithm is correct and validating with a secret key</li>
          </ul>

          <h3 class="text-lg font-bold mt-8 mb-2">Common Questions</h3>
          <div class="space-y-3">
            <div>
              <h4 class="font-semibold text-gray-800 dark:text-gray-200">Q: Can anyone read a JWT since it is only Base64-encoded?</h4>
              <p class="text-gray-500 dark:text-gray-400 mt-1">Yes, the Header and Payload of a JWT can be decoded by anyone. This is by design. The security of a JWT relies on the signature, not on hiding the payload. Never include sensitive information like passwords in a JWT.</p>
            </div>
            <div>
              <h4 class="font-semibold text-gray-800 dark:text-gray-200">Q: What do the claims exp, iat, and nbf mean?</h4>
              <p class="text-gray-500 dark:text-gray-400 mt-1">exp (Expiration) is when the token expires, iat (Issued At) is when it was created, and nbf (Not Before) is when it becomes valid. All are expressed as Unix timestamps in seconds. This tool converts these values into human-readable dates for convenience.</p>
            </div>
            <div>
              <h4 class="font-semibold text-gray-800 dark:text-gray-200">Q: What is the difference between RS256 and HS256?</h4>
              <p class="text-gray-500 dark:text-gray-400 mt-1">HS256 is a symmetric algorithm that uses the same secret key for both signing and verification. RS256 is an asymmetric algorithm that signs with a private key and verifies with a public key. This tool supports verification for HMAC-based algorithms (HS256/384/512) only.</p>
            </div>
            <div>
              <h4 class="font-semibold text-gray-800 dark:text-gray-200">Q: What are sub, iss, and aud claims used for?</h4>
              <p class="text-gray-500 dark:text-gray-400 mt-1">sub (Subject) identifies the principal the token represents (usually a user ID), iss (Issuer) identifies who issued the token, and aud (Audience) specifies the intended recipients. All are optional but recommended for proper security and token management.</p>
            </div>
            <div>
              <h4 class="font-semibold text-gray-800 dark:text-gray-200">Q: Can I decode a token after it has expired?</h4>
              <p class="text-gray-500 dark:text-gray-400 mt-1">Yes, expiration does not prevent decoding. You can always view the contents of any JWT regardless of its validity. Expiration determines whether a server should accept the token, not whether it can be read.</p>
            </div>
            <div>
              <h4 class="font-semibold text-gray-800 dark:text-gray-200">Q: What does a failed signature verification mean?</h4>
              <p class="text-gray-500 dark:text-gray-400 mt-1">It means either the secret key you entered does not match the one used to create the token, or the token contents may have been tampered with. A token with a failed signature should not be trusted.</p>
            </div>
            <div>
              <h4 class="font-semibold text-gray-800 dark:text-gray-200">Q: What is the jti claim?</h4>
              <p class="text-gray-500 dark:text-gray-400 mt-1">jti (JWT ID) is a unique identifier for the token. It is used to prevent token replay attacks. Servers can track used jti values to block reuse of the same token.</p>
            </div>
            <div>
              <h4 class="font-semibold text-gray-800 dark:text-gray-200">Q: Is my token or secret key sent anywhere?</h4>
              <p class="text-gray-500 dark:text-gray-400 mt-1">No. All decoding and signature verification happens entirely in your browser. Your tokens and keys are never transmitted to any server, so you can use this tool with confidence.</p>
            </div>
          </div>
        </div>
          <h3 class="text-lg font-bold mt-8 mb-2">Good to Know</h3>
          <ul class="list-disc pl-5 space-y-1.5">
            <li>JWT payloads are Base64-encoded, not encrypted. Never put sensitive data like passwords in a JWT.</li>
            <li>Signature verification only supports HMAC algorithms (HS256/384/512). RSA or EC signatures require separate tools.</li>
            <li>All decoding and verification happens in your browser. No tokens or keys are sent to any server.</li>
            <li>Tokens without an exp claim are treated as non-expiring. For security, always set an expiration time.</li>
            <li>Avoid entering production secret keys here. Use test keys whenever possible.</li>
          </ul>

      </section>
    </div>
  </main>

  <!-- Footer -->
  <div id="footer">
<footer class="mt-auto py-8 border-t border-gray-100 dark:border-gray-800">
  <div class="container-main">
    <div class="flex flex-col md:flex-row items-center justify-between gap-4 text-sm text-gray-500 dark:text-gray-400">
      <p>&copy; 2026 Toolneat. All rights reserved.</p>
      <div class="flex items-center gap-4">
        <a href="/en/pages/about" class="nav-link hover:text-gray-900 dark:hover:text-white transition-colors" data-i18n="footer.about">About</a>
        <a href="/en/pages/privacy" class="nav-link hover:text-gray-900 dark:hover:text-white transition-colors" data-i18n="footer.privacy">Privacy</a>
        <a href="/en/pages/terms" class="nav-link hover:text-gray-900 dark:hover:text-white transition-colors" data-i18n="footer.terms">Terms</a>
      </div>
    </div>
  </div>
</footer>

</div>
    </div>
  </div>
</footer>

</div>
    </div>
  </div>
</footer>

</div>
    </div>
  </div>
</footer>

</div>
    </div>
  </div>
</footer>

</div>

  <!-- Tool Script -->
  <script>
    (function() {
      'use strict';

      const jwtInput = document.getElementById('jwt-input');
      const pasteBtn = document.getElementById('paste-btn');
      const decodeBtn = document.getElementById('decode-btn');
      const errorMessage = document.getElementById('error-message');
      const results = document.getElementById('results');
      const tokenStatus = document.getElementById('token-status');
      const tokenPreview = document.getElementById('token-preview');
      const headerJson = document.getElementById('header-json');
      const payloadJson = document.getElementById('payload-json');
      const signatureValue = document.getElementById('signature-value');
      const claimsList = document.getElementById('claims-list');
      const secretKeyInput = document.getElementById('secret-key');
      const verifyBtn = document.getElementById('verify-btn');
      const verifyResult = document.getElementById('verify-result');

      let decodedData = {
        header: null,
        payload: null,
        signature: null
      };

      // Base64URL decode
      function base64UrlDecode(str) {
        // Replace URL-safe characters
        let base64 = str.replace(/-/g, '+').replace(/_/g, '/');

        // Pad with '='
        const pad = base64.length % 4;
        if (pad) {
          base64 += '='.repeat(4 - pad);
        }

        try {
          const decoded = atob(base64);
          // Handle UTF-8
          return decodeURIComponent(
            decoded.split('').map(c =>
              '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2)
            ).join('')
          );
        } catch (e) {
          throw new Error('Invalid Base64 encoding');
        }
      }

      // Format timestamp claim
      function formatTimestamp(ts) {
        const date = new Date(ts * 1000);
        return date.toLocaleString('en-US', {
          year: 'numeric',
          month: 'short',
          day: 'numeric',
          hour: '2-digit',
          minute: '2-digit',
          second: '2-digit'
        });
      }

      // Check token status
      function getTokenStatus(payload) {
        const now = Math.floor(Date.now() / 1000);

        if (payload.exp) {
          if (payload.exp < now) {
            const expiredAgo = now - payload.exp;
            const days = Math.floor(expiredAgo / 86400);
            const hours = Math.floor((expiredAgo % 86400) / 3600);
            const mins = Math.floor((expiredAgo % 3600) / 60);

            let agoText;
            agoText = days > 0 ? `${days}d ${hours}h ago` : hours > 0 ? `${hours}h ${mins}m ago` : `${mins}m ago`;

            return {
              status: 'expired',
              message: `Expired (${agoText})`,
              class: 'bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-700 dark:text-red-300'
            };
          }
        }

        if (payload.nbf && payload.nbf > now) {
          return {
            status: 'not-yet',
            message: 'Not yet valid (nbf)',
            class: 'bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 text-yellow-700 dark:text-yellow-300'
          };
        }

        if (payload.exp) {
          const remaining = payload.exp - now;
          const days = Math.floor(remaining / 86400);
          const hours = Math.floor((remaining % 86400) / 3600);
          const mins = Math.floor((remaining % 3600) / 60);

          let remainText;
          remainText = days > 0 ? `${days}d ${hours}h remaining` : hours > 0 ? `${hours}h ${mins}m remaining` : `${mins}m remaining`;

          return {
            status: 'valid',
            message: `Valid (${remainText})`,
            class: 'bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 text-green-700 dark:text-green-300'
          };
        }

        return {
          status: 'unknown',
          message: 'No expiration',
          class: 'bg-gray-100 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 text-gray-700 dark:text-gray-300'
        };
      }

      // Decode JWT
      function decodeJWT() {
        const jwt = jwtInput.value.trim();

        // Reset
        errorMessage.classList.add('hidden');
        results.classList.add('hidden');

        if (!jwt) {
          errorMessage.textContent = 'Please enter a JWT token';
          errorMessage.classList.remove('hidden');
          return;
        }

        // Split JWT
        const parts = jwt.split('.');
        if (parts.length !== 3) {
          errorMessage.textContent = 'Invalid JWT format. JWT must have three parts separated by dots.';
          errorMessage.classList.remove('hidden');
          return;
        }

        try {
          // Decode header
          const headerStr = base64UrlDecode(parts[0]);
          const header = JSON.parse(headerStr);

          // Decode payload
          const payloadStr = base64UrlDecode(parts[1]);
          const payload = JSON.parse(payloadStr);

          // Store decoded data
          decodedData = {
            header: header,
            payload: payload,
            signature: parts[2]
          };

          // Display results
          displayResults(parts, header, payload);

        } catch (e) {
          errorMessage.textContent = 'Failed to decode JWT: ' + e.message;
          errorMessage.classList.remove('hidden');
        }
      }

      // Display results
      function displayResults(parts, header, payload) {
        // Token preview
        tokenPreview.innerHTML = `<span class="token-header">${parts[0]}</span>.<span class="token-payload">${parts[1]}</span>.<span class="token-signature">${parts[2]}</span>`;

        // Token status
        const status = getTokenStatus(payload);
        tokenStatus.className = `mb-6 p-4 rounded-xl ${status.class}`;
        tokenStatus.innerHTML = `
          <div class="flex items-center gap-2">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              ${status.status === 'valid' ?
                '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>' :
                status.status === 'expired' ?
                '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"/>' :
                '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>'}
            </svg>
            <span class="font-medium">${status.message}</span>
          </div>
        `;

        // Header JSON
        headerJson.textContent = JSON.stringify(header, null, 2);

        // Payload JSON
        payloadJson.textContent = JSON.stringify(payload, null, 2);

        // Signature
        signatureValue.textContent = parts[2];

        // Claims list
        const timestampClaims = ['exp', 'nbf', 'iat'];
        const claimDescriptions = {
          iss: 'Issuer',
          sub: 'Subject',
          aud: 'Audience',
          exp: 'Expiration',
          nbf: 'Not Before',
          iat: 'Issued At',
          jti: 'JWT ID'
        };

        let claimsHtml = '';
        for (const [key, value] of Object.entries(payload)) {
          let displayValue = value;
          let extra = '';

          if (timestampClaims.includes(key) && typeof value === 'number') {
            displayValue = value;
            extra = `<span class="text-xs text-gray-500 dark:text-gray-400 ml-2">(${formatTimestamp(value)})</span>`;

            // Add status indicator for exp
            if (key === 'exp') {
              const now = Math.floor(Date.now() / 1000);
              if (value < now) {
                extra += `<span class="ml-2 px-1.5 py-0.5 text-xs bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 rounded">Expired</span>`;
              }
            }
          } else if (typeof value === 'object') {
            displayValue = JSON.stringify(value);
          }

          const description = claimDescriptions[key] ? ` <span class="text-xs text-gray-400">(${claimDescriptions[key]})</span>` : '';

          claimsHtml += `
            <div class="claim-row">
              <span class="claim-key">${key}${description}</span>
              <span class="claim-value">${displayValue}${extra}</span>
            </div>
          `;
        }

        claimsList.innerHTML = claimsHtml || `<p class="text-gray-500 dark:text-gray-400 text-sm">No claims</p>`;

        results.classList.remove('hidden');
      }

      // Verify signature using Web Crypto API
      async function verifySignature() {
        const jwt = jwtInput.value.trim();
        const secret = secretKeyInput.value;

        if (!jwt || !decodedData.header) {
          toast.warning('Please decode a JWT first');
          return;
        }

        if (!secret) {
          toast.warning('Please enter a secret key');
          return;
        }

        const alg = decodedData.header.alg;
        const parts = jwt.split('.');
        const data = parts[0] + '.' + parts[1];

        // Check if algorithm is supported
        const algMap = {
          'HS256': { name: 'HMAC', hash: 'SHA-256' },
          'HS384': { name: 'HMAC', hash: 'SHA-384' },
          'HS512': { name: 'HMAC', hash: 'SHA-512' }
        };

        if (!algMap[alg]) {
          verifyResult.className = 'mt-2 p-2 rounded text-sm bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-300';
          verifyResult.textContent = `Algorithm ${alg} is not supported. Only HMAC (HS256/384/512) is supported.`;
          verifyResult.classList.remove('hidden');
          return;
        }

        try {
          const encoder = new TextEncoder();
          const keyData = encoder.encode(secret);
          const dataBytes = encoder.encode(data);

          const cryptoKey = await crypto.subtle.importKey(
            'raw',
            keyData,
            algMap[alg],
            false,
            ['sign']
          );

          const signatureBytes = await crypto.subtle.sign(
            algMap[alg].name,
            cryptoKey,
            dataBytes
          );

          // Convert computed signature to base64url
          const computedSig = btoa(String.fromCharCode(...new Uint8Array(signatureBytes)))
            .replace(/\+/g, '-').replace(/\//g, '_').replace(/=/g, '');

          // Compare with original signature
          const isValid = computedSig === parts[2];

          if (isValid) {
            verifyResult.className = 'mt-2 p-2 rounded text-sm bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300';
            verifyResult.innerHTML = `<span class="flex items-center gap-1"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg> Signature is valid!</span>`;
          } else {
            verifyResult.className = 'mt-2 p-2 rounded text-sm bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300';
            verifyResult.innerHTML = `<span class="flex items-center gap-1"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg> Signature does not match.</span>`;
          }
          verifyResult.classList.remove('hidden');

        } catch (e) {
          verifyResult.className = 'mt-2 p-2 rounded text-sm bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300';
          verifyResult.textContent = 'Error during verification.';
          verifyResult.classList.remove('hidden');
        }
      }

      // Event listeners
      decodeBtn.addEventListener('click', decodeJWT);
      verifyBtn.addEventListener('click', verifySignature);

      jwtInput.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' && e.ctrlKey) {
          decodeJWT();
        }
      });

      // Auto-decode on paste
      jwtInput.addEventListener('paste', () => {
        setTimeout(decodeJWT, 100);
      });

      pasteBtn.addEventListener('click', async () => {
        try {
          const text = await navigator.clipboard.readText();
          jwtInput.value = text;
          decodeJWT();
        } catch (e) {
          toast.error('Failed to paste from clipboard');
        }
      });

      // Copy part buttons
      document.querySelectorAll('.copy-part-btn').forEach(btn => {
        btn.addEventListener('click', async () => {
          const part = btn.dataset.part;
          let text = '';

          if (part === 'header') {
            text = JSON.stringify(decodedData.header, null, 2);
          } else if (part === 'payload') {
            text = JSON.stringify(decodedData.payload, null, 2);
          } else if (part === 'signature') {
            text = decodedData.signature;
          }

          await copyToClipboard(text);
          toast.success('Copied!');
        });
      });
    })();
  </script>
</body>
</html>
